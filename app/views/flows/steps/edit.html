<div id="full_page">
  <div class="header">
    <a href="#/flows/{{ flow.id }}" class="back">
      <span class="glyphicon glyphicon-chevron-left"></span>
    </a>

    <div class="title" ng-show="!updating">
      {{ step.title }} <a href="" ng-click="editStep()" class="editIcon"><span class="glyphicon glyphicon-edit"></span></a>
    </div>

    <div class="updated-msg" style="display: none;">
      <span class="glyphicon glyphicon-check"></span> Todas as alterações foram salvas.
    </div>
  </div>

  <div class="spacing"></div>

  <div class="tabs edit">
    <a href="" ng-click="currentTab = 'form'" ng-class="{'active': currentTab == 'form'}">Formulário</a>
    <a href="" ng-click="currentTab = 'permissions'" ng-class="{'active': currentTab == 'permissions'}">Permissões</a>
    <a href="" ng-click="currentTab = 'triggers'" ng-class="{'active': currentTab == 'triggers'}">Gatilhos</a>
  </div>

  <div class="loading" ng-show="loading"></div>

  <div class="big_content" class="pages-animation edit-form" ng-show="currentTab == 'form' && !loading">
    <div class="left_column">
      <div class="empty_section" ng-show="fields.length === 0"><p>Arreste os campos que você deseje adicionar a esta etapa abaixo.</p></div>

      <div flow-droppable-inputs-area class="step-form droppableInputsArea">
        <div class="input pages-animation form-group clearfix" ng-repeat="field in fields | orderBy:'order_number'" id="input_{{ field.id }}" ng-hide="field.destroy" flow-step-field>
          <div class="form-inputs">
            <label for="generic_input_{{ field.id }}" class="input_name" ng-hide="editingLabel" ng-click="editingLabel = true">
              {{ field.title }}
              <span ng-show="field.required == true"> *</span>
            </label>

            <div class="edit_label" ng-show="editingLabel">
              <input type="text" ng-model="field.title" />
              <a href="" ng-click="saveTitle()">Salvar</a>

              <div class="clearfix"></div>
            </div>

            <div class="clearfix"></div>

            <!-- input type: text, url, email -->
            <input class="form-control" id="generic_input_{{ field.id }}" type="text" ng-show="field.field_type == 'text' || field.field_type == 'url' || field.field_type == 'email'" disabled="disabled">

            <!-- input type date, time, cpf, cnpj -->
            <div class="custom_size col-xs-3" ng-show="field.field_type == 'date' || field.field_type == 'time' || field.field_type == 'cpf' || field.field_type == 'cnpj'">
              <input class="form-control" id="generic_input_{{ field.id }}" type="text" disabled="disabled">
            </div>

            <!-- input type: integer, decimal -->
            <input class="form-control integer" id="generic_input_{{ field.id }}" type="text" ng-show="field.field_type == 'integer' || field.field_type == 'decimal'" disabled="disabled">

            <!-- input type: meters -->
            <div class="input-group col-xs-3" ng-show="field.field_type == 'meters'">
              <input type="text" id="generic_input_{{ field.id }}" class="form-control" type="text" disabled="disabled">
              <span class="input-group-addon">metros</span>
            </div>

            <!-- input type: centimeters -->
            <div class="input-group col-xs-3" ng-show="field.field_type == 'centimeters'">
              <input type="text" id="generic_input_{{ field.id }}" class="form-control" type="text" disabled="disabled">
              <span class="input-group-addon">cm</span>
            </div>

            <!-- input type: kilometers -->
            <div class="input-group col-xs-3" ng-show="field.field_type == 'kilometers'">
              <input type="text" id="generic_input_{{ field.id }}" class="form-control" type="text" disabled="disabled">
              <span class="input-group-addon">km</span>
            </div>

            <!-- input type: years -->
            <div class="input-group col-xs-3" ng-show="field.field_type == 'years'">
              <input type="text" id="generic_input_{{ field.id }}" class="form-control" type="text" disabled="disabled">
              <span class="input-group-addon">anos</span>
            </div>

            <!-- input type: months -->
            <div class="input-group col-xs-3" ng-show="field.field_type == 'months'">
              <input type="text" id="generic_input_{{ field.id }}" class="form-control" type="text" disabled="disabled">
              <span class="input-group-addon">meses</span>
            </div>

            <!-- input type: days -->
            <div class="input-group col-xs-3" ng-show="field.field_type == 'days'">
              <input type="text" id="generic_input_{{ field.id }}" class="form-control" type="text" disabled="disabled">
              <span class="input-group-addon">dias</span>
            </div>

            <!-- input type: hours -->
            <div class="input-group col-xs-3" ng-show="field.field_type == 'hours'">
              <input type="text" id="generic_input_{{ field.id }}" class="form-control" type="text" disabled="disabled">
              <span class="input-group-addon">horas</span>
            </div>

            <!-- input type: seconds -->
            <div class="input-group col-xs-3" ng-show="field.field_type == 'seconds'">
              <input type="text" id="generic_input_{{ field.id }}" class="form-control" type="text" disabled="disabled">
              <span class="input-group-addon">segundos</span>
            </div>

            <!-- input type: angle -->
            <div class="input-group col-xs-3" ng-show="field.field_type == 'angle'">
              <span class="input-group-addon">ângulo</span>
              <input type="text" id="generic_input_{{ field.id }}" class="form-control" type="text" disabled="disabled">
            </div>

            <div ng-show="kindHasMultipleOptions(field.field_type) === true" class="multipleValues">
              <div ng-repeat="value in field.available_values track by $index" inventory-single-value>
                <input type="checkbox" class="value">

                <a href="" class="edit_value" ng-click="editingValue = true" ng-hide="editingValue">{{ value }}</a>

                <div class="edit_label" ng-show="editingValue">
                  <input type="text" ng-model="editValue" />
                  <a href="" ng-click="saveValue()">Ok</a>

                  <div class="clearfix"></div>
                </div>

                <a href="" class="remove_value" ng-click="removeValue(value)"><span class="glyphicon glyphicon-remove"></span></a>

                <div class="clearfix"></div>
              </div>

              <a href="" ng-click="newValue()" class="newItem" inventory-create-value>+ Novo item</a>
            </div>
          </div>

          <div class="actions">
            <div class="option move">
              <a href="" class="handle icon"><span class="glyphicon glyphicon-resize-vertical"></span></a>
            </div>

            <div class="option trash" ng-hide="field.location === true">
              <div class="popover bottom" inventory-popover="remove" ng-show="popover.remove">
                <div class="arrow"></div>
                <h3 class="popover-title">Remover campo {{ field.label }}</h3>

                <div class="popover-content">
                  <div class="row">
                    <div class="col-xs-6"><a href="" ng-click="popover.remove = false" class="btn btn-default btn-block">Cancelar</a></div>
                    <div class="col-xs-6"><a href="" ng-click="removeField()" class="btn btn-danger btn-block">Remover</a></div>
                  </div>
                </div>
              </div>

              <a href="" ng-click="openPopover('remove')" class="icon" inventory-popover-link><span class="glyphicon glyphicon-trash"></span></a>
            </div>

            <div class="option edit">
              <div class="popover bottom" inventory-popover="options" ng-show="popover.options">
                <div class="arrow"></div>
                <h3 class="popover-title">Opções do campo {{ field.label }}</h3>

                <div class="popover-content">
                  <div class="form-group">
                    <label>Preenchimento requerido?</label>

                    <br />

                    <label class="radio-inline">
                      <input type="radio" ng-model="field.requirements.presence" value="true"> Sim
                    </label>

                    <label class="radio-inline">
                      <input type="radio" ng-model="field.requirements.presence" value="false"> Não
                    </label>
                  </div>

                  <div class="row">
                    <div class="col-xs-6">
                      <div class="form-group">
                        <label>Min. de caracteres</label>
                        <input type="number" class="form-control" ng-model="field.requirements.minimum" />
                      </div>
                    </div>

                    <div class="col-xs-6">
                      <div class="form-group">
                        <label>Máx. de caracteres</label>
                        <input type="number" class="form-control" ng-model="field.requirements.maximum" />
                      </div>
                    </div>
                  </div>

                  <a href="" ng-click="saveField()" class="btn btn-info btn-fat-custom btn-custom pull-right">Pronto</a>

                  <div class="clearfix"></div>
                </div>
              </div>

              <a href="" ng-click="openPopover('options')" class="icon" inventory-popover-link><span class="glyphicon glyphicon-edit"></span></a>
            </div>
          </div>

          <div class="clearfix"></div>
        </div>
      </div>
    </div>

    <div class="right_column" inputs-sidebar>
      <div class="inputs step-sidebar">
        <div class="info"><p>Campos básicos</p></div>

        <div class="clearfix"></div>

        <div class="simple_search">
          <span class="glyphicon glyphicon-search search_icon"></span>
          <input type="text" placeholder="Buscar..." ng-model="searchInputs" />
        </div>

        <div class="list">
          <div class="item" ng-repeat="input in availableInputs.normal | filter: searchInputs" name="{{ input.kind }}" draggable-input><p>{{ input.name }}</p></div>
        </div>
      </div>

      <div class="inputs step-sidebar-bottom">
        <div class="info">
          <p>Campos especiais</p>
        </div>

        <div class="clearfix"></div>

        <div class="list">
          <div class="item" ng-repeat="input in availableInputs.special" name="{{ input.kind }}" draggable-input><p>{{ input.name }}</p></div>
        </div>
      </div>
    </div>

    <div class="clearfix"></div>
  </div>

  <div class="pages-animation edit-permissions" ng-show="currentTab == 'permissions' && !loading">
    <form>
      <h3>Permissões para executar</h3>

      <div class="form-group custom-switch">
        <label>Modo de Condução</label>

        <div class="clearfix"></div>

        <input bs-switch type="checkbox" ng-model="lol" switch-on-label="Modo aberto" switch-off-label="Modo seletivo">
     </div>

      <div class="form-group">
        <label>Grupos que podem executar a etapa</label>
        <div class="selectUsers">
          <div class="ui-widget">
            <span class="search_icon"></span>
            <span role="status" aria-live="polite" class="ui-helper-hidden-accessible"></span>
            <input type="text" placeholder="Buscar grupos" ng-model="inventories_autocomplete" ui-autocomplete="categoriesAutocomplete" class="ui-autocomplete-input ng-pristine ng-valid" autocomplete="off">
          </div>

          <ul>
            <li>GrupoX <button type="button" class="remove">×</button></li>
            <li>GrupoY <button type="button" class="remove">×</button></li>
            <li>GrupoZ <button type="button" class="remove">×</button></li>
          </ul>
        </div>
      </div>
      <h3>Permissões para visualizar</h3>
      <div class="form-group">
        <label>Grupos que podem executar a etapa</label>
        <div class="selectUsers">
          <div class="ui-widget">
            <span class="search_icon"></span>
            <span role="status" aria-live="polite" class="ui-helper-hidden-accessible"></span>
            <input type="text" placeholder="Buscar grupos" ng-model="inventories_autocomplete" ui-autocomplete="categoriesAutocomplete" class="ui-autocomplete-input ng-pristine ng-valid" autocomplete="off">
          </div>

          <ul>
            <li>GrupoX <button type="button" class="remove">×</button></li>
            <li>GrupoY <button type="button" class="remove">×</button></li>
            <li>GrupoZ <button type="button" class="remove">×</button></li>
          </ul>
        </div>
      </div>
    </form>
    <div class="clearfix"></div>
  </div>

  <div class="pages-animation edit-triggers" ng-show="currentTab == 'triggers' && !loading">
    <div class="edit-triggers-header clearfix">
      <p>4 gatilhos criados</p>
      <a href="#/inventories/categories/add" class="btn btn-info btn-custom">+ Novo gatilho</a>
    </div>

    <ul>
      <li>
        <div class="list-triggers-item">
          <div class="item-content">
            <p class="name">Título do gatilho</p>

            <div class="actions">
              <a href="">
                <span class="glyphicon glyphicon-trash"></span>
              </a>
              <a href="" class="middle-link">
                <span class="glyphicon glyphicon-resize-vertical"></span>
              </a>
              <a href="" class="right-link">
                <span class="arrow_icon"></span>
              </a>
            </div>

            <div class="clearfix"></div>
          </div>
        </div>
      </li>
      <li>
        <div class="list-triggers-item">
          <div class="item-content">
            <p class="name">Título do gatilho</p>

            <div class="actions">
              <a href="">
                <span class="glyphicon glyphicon-trash"></span>
              </a>
              <a href="" class="middle-link">
                <span class="glyphicon glyphicon-resize-vertical"></span>
              </a>
              <a href="" class="right-link">
                <span class="arrow_icon"></span>
              </a>
            </div>

            <div class="clearfix"></div>
          </div>
        </div>
      </li>
      <li>
        <div class="list-triggers-item">
          <div class="item-content">
            <p class="name">Título do gatilho</p>

            <div class="actions">
              <a href="">
                <span class="glyphicon glyphicon-trash"></span>
              </a>
              <a href="" class="middle-link">
                <span class="glyphicon glyphicon-resize-vertical"></span>
              </a>
              <a href="" class="right-link">
                <span class="arrow_icon"></span>
              </a>
            </div>

            <div class="clearfix"></div>
          </div>
        </div>
      </li>
      <li>
        <div class="list-triggers-item active">
          <div class="item-content">
            <p class="name">Título do gatilho</p>

            <div class="actions">
              <a href="">
                <span class="glyphicon glyphicon-trash"></span>
              </a>
              <a href="" class="middle-link">
                <span class="glyphicon glyphicon-resize-vertical"></span>
              </a>
              <a href="" class="right-link">
                <span class="arrow_icon"></span>
              </a>
            </div>
            <div class="clearfix"></div>
          </div>

          <table class="item-table">
            <thead>
              <tr>
                <td width="35%">Campo</td>
                <td width="25%">Condição</td>
                <td width="35%">Campo</td>
                <td width="5%"></td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>
                  <label class="select-trigger">
                    <select class="form-control">
                      <option>Distância máxima até a central</option>
                    </select>
                  </label>
                </td>
                <td>
                  <label class="select-trigger">
                    <select class="form-control">
                      <option>Maior</option>
                    </select>
                  </label>
                </td>
                <td>
                  <input type="text" class="form-control" value="3500">
                </td>
                <td class="remove-condition">
                  <button type="button" class="remove" ng-click="remove_status = true">x</button>
                </td>
              </tr>
              <tr>
                <td>
                  <label class="select-trigger">
                    <select class="form-control">
                      <option>Inclinação</option>
                    </select>
                  </label>
                </td>
                <td>
                  <label class="select-trigger">
                    <select class="form-control">
                      <option>Menor</option>
                    </select>
                  </label>
                </td>
                <td>
                  <input type="text" class="form-control" value="45">
                </td>
                <td class="remove-condition">
                  <button type="button" class="remove" ng-click="remove_status = true">x</button>
                </td>
              </tr>
              <tr>
                <td colspan="4" class="new-condition class="remove-condition"">
                  <a href="#/inventories/categories/add" class="btn btn-info btn-custom">+ Nova condição</a>
                </td>
              </tr>
            </tbody>
          </table>

          <div class="item-conditions">
            <h3>Caso as condições sejam verdadeiras</h3>
            <form action="">
              <div class="form-group clearfix">
                <div class="item-conditions-content content-first">
                  <label for="">Selecione uma ação</label>
                  <label class="select-trigger">
                    <select class="form-control">
                      <option>Finalizar caso</option>
                    </select>
                  </label>
                </div>
                <div class="item-conditions-content">
                  <label for="">Alterar estado de resolução para</label>
                  <label class="select-trigger">
                    <select class="form-control">
                      <option>Impossibilidade técnica</option>
                    </select>
                  </label>
                </div>
              </div>
              <div class="form-group">
                <label for="">Descrição</label>
                <textarea class="form-control" rows="4" placeholder="Caso finalizado devido a impossibilidade técnica"></textarea>
              </div>
            </form>
          </div>
        </div>
      </li>
      <li>
        <div class="list-triggers-item">
          <div class="item-content">
            <p class="name">Título do gatilho</p>

            <div class="actions">
              <a href="">
                <span class="glyphicon glyphicon-trash"></span>
              </a>
              <a href="" class="middle-link">
                <span class="glyphicon glyphicon-resize-vertical"></span>
              </a>
              <a href="" class="right-link">
                <span class="arrow_icon"></span>
              </a>
            </div>

            <div class="clearfix"></div>
          </div>
        </div>
      </li>
      <li>
        <div class="list-triggers-item">
          <div class="item-content">
            <p class="name">Título do gatilho</p>

            <div class="actions">
              <a href="">
                <span class="glyphicon glyphicon-trash"></span>
              </a>
              <a href="" class="middle-link">
                <span class="glyphicon glyphicon-resize-vertical"></span>
              </a>
              <a href="" class="right-link">
                <span class="arrow_icon"></span>
              </a>
            </div>

            <div class="clearfix"></div>
          </div>
        </div>
      </li>
    </ul>
  </div>
</div>
