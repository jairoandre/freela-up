<div id="main_layout" nv-file-drop uploader="uploader">
  <div id="sidebar" hack-sidebar-height>
    <!-- Include views/layouts/menu.html -->
    <div ng-include="'views/layout/menu.html'"></div>
  </div>

  <div id="main_content" class="custom-manage-category">
    <!-- Include views/layouts/header.html -->
    <div ng-include="'views/layout/header.html'"></div>

    <div class="loading" ng-show="loading"></div>

    <div ng-hide="loading" class="pages-animation">
      <div class="title">
        <ul>
          <li><a href="#/reports">Relatos</a></li>
          <li><a href="#/reports/categories">Gerenciar categorias</a></li>
          <li><span ng-hide="updating">Nova categoria</span><span ng-show="updating">{{ category.title }}</span></li>
        </ul>
      </div>

      <div class="content">
        <h3>Informações da categoria</h3>

        <div class="alert alert-danger fade-animation" ng-show="inputErrors">
          <p ng-bind-html="inputErrors | formatErrors"></p>
        </div>

        <form ng-submit="send()">

          <div style="width: 80%">
            <div class="form-group">
              <label for="form_name">Nome da categoria</label>
              <input type="text" class="form-control input-lg" id="form_name" ng-model="category.title" generic-input name="title">
            </div>

            <div class="form-group">
              <label>Categoria de inventário relacionada</label>

              <div class="selectUsers">

                <div class="ui-widget">
                  <span class="search_icon"></span>
                  <input type="text" placeholder="Buscar categorias de inventário..." ng-model="inventories_autocomplete" ui-autocomplete="categoriesAutocomplete" class="ui-autocomplete-input">
                </div>

                <ul>
                  <li ng-repeat="id in category.inventory_categories"><span ng-repeat="category in categories" ng-show="category.id == id">{{ category.title }}</span> <button type="button" class="remove" ng-click="removeCategory(id)">&times;</button></li>
                </ul>
              </div>

              <!--<select multiple class="form-control" ng-model="category.inventory_categories" ng-options="category.id as category.title for category in categories">
              </select>-->
            </div>

            <div class="form-group upload">
              <label>Ícone da categoria <span>(60x60px)</span></label>

              <div class="queue">
                <div ng-show="uploader.isHTML5" class="drop-zone" nv-file-over uploader="uploader" ng-style="{'background-color': category.color}">
                  <span ng-show="uploader.queue.length == 0" ng-hide="icon">Arraste o ícone</span>

                  <div class="image" ng-show="icon && uploader.queue.length == 0">
                    <img ng-src="{{ icon }}" width="65" height="65">
                  </div>

                  <div class="image" ng-repeat="item in uploader.queue">
                    <div ng-thumb="{ file: item._file, width: 60, height: 60 }"></div>
                  </div>
                </div>
              </div>

              <div class="btn btn-default btn-upload">
                  <span>Selecione um arquivo</span>

                  <input nv-file-select uploader="uploader" type="file" multiple  />
              </div>
            </div>

            <div class="form-group">
              <label>Cor representativa</label>
              <div class="row">
                <div class="col-md-2" generic-input name="color">
                  <button colorpicker type="button" colorpicker-position="top" class="btn btn-colorpicker" ng-model="category.color" ng-style="{'background-color': category.color}"></button>
                </div>
              </div>
            </div>
          </div>

          <hr />

          <h3>Configurações de relato</h3>

          <div class="form-group">
            <label>Tempo de resolução do relato</label>
            <div class="row">
              <div class="col-md-1">
                <input type="text" class="form-control input-lg" ng-model="category.resolution_time" generic-input name="resolution_time">
              </div>

              <div class="col-md-2" style="padding: 0px;">
                <div class="btn-group">
                  <button type="button" class="btn btn-default dropdown-custom-small dropdown-toggle input-lg" data-toggle="dropdown">
                  <span ng-show="defaultResolutionTimeSelection == 60">Minutos</span> <span ng-show="defaultResolutionTimeSelection == 3600">Horas</span> <span class="pull-right"><span class="caret"></span></span>
                  </button>

                  <ul class="dropdown-menu" role="menu">
                    <li ng-class="{active: defaultResolutionTimeSelection == 60}"><a href="" ng-click="defaultResolutionTimeSelection = 60">Minutos</a></li>
                    <li ng-class="{active: defaultResolutionTimeSelection == 3600}"><a href="" ng-click="defaultResolutionTimeSelection = 3600">Horas</a></li>
                  </ul>
                </div>
              </div>
            </div>
          </div>

          <div class="form-group">
            <label generic-input name="statuses">Estados de relatos disponíveis <a href="" ng-click="manageStatuses()">(Gerenciar estados)</a></label>

            <ul class="statuses-list">
              <li ng-repeat="status in category.statuses"><span ng-style="{'background-color': status.color}"></span> {{ status.title }}</li>
            </ul>
          </div>

          <div class="form-group">
            <label>Permitir criar relatos em pontos livres</label>

            <div class="clearfix"></div>

            <input type="checkbox" bs-switch ng-model="category.allows_arbitrary_position">
          </div>

          <div class="form-group">
            <label>Feedback do usuário</label>
            <div class="row">
              <div class="col-md-2" style="padding-top: 9px;">
                <input type="checkbox" class="pull-right" bs-switch ng-model="enabledUserResponseTime">
              </div>

              <div class="col-md-1" style="padding: 0px;">
                <input type="text" class="form-control input-lg" ng-model="category.user_response_time" generic-input name="user_response_time" ng-show="enabledUserResponseTime">
              </div>

              <div class="col-md-2">
                <div class="btn-group" ng-show="enabledUserResponseTime">
                  <button type="button" class="btn btn-default dropdown-custom-small dropdown-toggle input-lg" data-toggle="dropdown">
                  <span ng-show="defaultUserResponseTimeSelection == 60">Minutos</span> <span ng-show="defaultUserResponseTimeSelection == 3600">Horas</span> <span class="pull-right"><span class="caret"></span></span>
                  </button>

                  <ul class="dropdown-menu" role="menu">
                    <li ng-class="{active: defaultUserResponseTimeSelection == 60}"><a href="" ng-click="defaultUserResponseTimeSelection = 60">Minutos</a></li>
                    <li ng-class="{active: defaultUserResponseTimeSelection == 3600}"><a href="" ng-click="defaultUserResponseTimeSelection = 3600">Horas</a></li>
                  </ul>
                </div>
              </div>
            </div>
          </div>

          <hr />

          <button type="submit" class="btn btn-info btn-custom btn-lg-custom" ng-hide="updating">Criar categoria</button>

          <button type="submit" class="btn btn-info btn-custom btn-lg-custom" ng-show="updating">Atualizar categoria</button>

        </form>
      </div>
    </div>

  </div>
</div>
