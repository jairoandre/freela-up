<div class="modal-header">
  <button type="button" class="close" ng-click="close()">&times;</button>
  <h3 class="modal-title">Emitir notificação</h3>
</div>

<div class="modal-body">

  <div ng-if="showModalMessage" class="message-status fade-animation" ng-class="modalMessage.messageClass">
    <p><span class="glyphicon" ng-class="glyphicons[modalMessage.icon]"></span> {{ modalMessage.text }}</p>
  </div>

  <div class="table-div">
    <table id="reports-nofitications-table" class="table custom_table items-listing-table" ng-if="notifications">
      <thead>
        <tr>
          <td class="type-cell">
            <span>Tipo</span>
          </td>
          <td class="status-cell">
            <span>Estado vinculado</span>
          </td>
          <td class="overdue-cell">
            <span>Prazo total</span>
          </td>
          <td class="date-cell">
            <span>Data de emissão</span>
          </td>
          <td class="overdue-cell">
            <span>Prazo Restante</span>
          </td>
          <td class="button-cell"></td>
        </tr>
      </thead>
      <tbody>
        <tr ng-repeat="notification in notifications | orderBy:'notification_type.order'"
            ng-click="openReport(report.id, $event)">
          <td class="type-cell" title="{{notification.notification_type.title}}">
            <a href="" display-notification="notification.notification_type.layout">
              <span class="glyphicon glyphicon-search"></span>
            </a>&nbsp;&nbsp;<b>{{notification.notification_type.title }}</b>
          </td>
          <td class="status-cell">
            <div ng-if="notification.notification_type.status.id">
              <span class="status-color" ng-style="{'background-color': notification.notification_type.status.color}"></span>
              &nbsp;{{notification.notification_type.status.title}}
            </div>
            <div ng-if="!notification.notification_type.status.id">-</div>
          </td>
          <td class="overdue-cell">
            <span ng-if="!loadingInfo">{{ getDefaultDeadlineInDaysTxt(notification) }}</span>
            <div class="loading_dots" ng-if="loadingInfo">
              <span></span>
              <span></span>
              <span></span>
            </div>
          </td>
          <td class="date-cell">
            <span ng-if="!loadingInfo">{{ notification.created_at ? (notification.created_at | date:'dd/MM/yy') : '-'}}</span>
            <div class="loading_dots" ng-if="loadingInfo">
              <span></span>
              <span></span>
              <span></span>
            </div>
          </td>
          <td class="overdue-cell">
            <span ng-if="!loadingInfo">{{ getDaysToDeadlineTxt(notification) }}</span>
            <div class="loading_dots" ng-if="loadingInfo">
              <span></span>
              <span></span>
              <span></span>
            </div>
          </td>
          <td class="button-cell">
            <button class="btn btn-info btn-custom"
                    ng-click="send(notification)"
                    ng-if="notification.able_to_send && !confirmSendMap[notification.notification_type.id]">
              {{ notification.sent ? 'Reemitir' : 'Emitir' }}
            </button>
            <button class="btn btn-success btn-custom"
                    style="background: #5cb85c"
                    ng-click="confirmSend(notification)"
                    ng-if="notification.able_to_send && confirmSendMap[notification.notification_type.id]"
                    promise-btn="sendPromise">Confirmar
            </button>
            <button class="btn btn-info btn-custom"
                    ng-if="!notification.sent && !notification.able_to_send"
                    disabled="true">Emitir
            </button>
            <div class="reports-notification-emitted" ng-if="notification.sent && !notification.able_to_send">
              <b><span class="glyphicon glyphicon-ok"></span>&nbsp;&nbsp;Emitida</b>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<div class="modal-footer">
  <a href=""
     confirm-dialog
     cd-modal-title="Reiniciar processo de notificações"
     cd-warning-msg="Atenção, você está prestes a reiniciar o processo de notificações. Ao confirmar, você esta ciente de sua responsabilidade por esta ação."
     cd-confirm-text="REINICIAR"
     cd-button-label="Reiniciar"
     cd-confirm-function="restartProcess()"
     cd-confirm-promise="restartProcessPromise"
     ng-if="showRestartProcessLink"
     style="float: left; font-weight: bold">Reiniciar</a>
</div>
