<div class="loading" ng-show="loading"></div>

<div ng-hide="loading" class="pages-animation">
  <div class="title">
    <ul>
      <li><a href="#/reports">Relatos</a></li>
      <li>Gerenciar categorias</li>
    </ul>

    <a href="#/reports/categories/add" class="btn btn-info btn-custom" ng-show="hasPermission('reports_full_access')">+ Nova categoria</a>
  </div>

  <table class="table custom_table big_text">
    <tbody ng-repeat="category in categories">
      <tr>
        <td><img ng-src="{{ category.icon.default.web.active }}" width="50" class="category-icon"> <a href="#/reports/categories/{{ category.id }}/edit">{{ category.title }}</a></td>
        <td width="90">
          <a href="#/reports/categories/{{ category.id }}/edit"><span class="glyphicon glyphicon-edit"></span></a>
          <a href="" ng-click="deleteCategory(category)" ng-show="category.subcategories.length === 0"><span class="glyphicon glyphicon-trash">
          </span></a>
          <span class="glyphicon glyphicon-trash ghost-icon" ng-show="category.subcategories.length !== 0" tooltip="Você não pode remover uma categoria de relato se existir subcategorias." tooltip-append-to-body="true" tooltip-placement="left"></span>
        </td>
      </tr>

      <tr ng-repeat="subCategory in category.subcategories" class="subrow">
        <td>
          <img ng-src="{{ subCategory.icon.default.web.active }}" width="30" class="category-icon"> <span class="sub-tag"></span>

          <a href="#/reports/categories/{{ subCategory.id }}/edit" ng-show="hasPermission('reports_categories_edit', subCategory.id) || hasPermission('reports_full_access')">{{ subCategory.title }}</a>

          <span ng-hide="hasPermission('reports_categories_edit', subCategory.id) || hasPermission('reports_full_access')">{{ subCategory.title }}</span>
        </td>

        <td width="90" ng-show="hasPermission('reports_categories_edit', subCategory.id) || hasPermission('reports_full_access')">
          <a href="#/reports/categories/{{ subCategory.id }}/edit"><span class="glyphicon glyphicon-edit"></span></a>

          <a href="" ng-click="deleteCategory(subCategory)"><span class="glyphicon glyphicon-trash"></span></a>
        </td>

        <td ng-hide="hasPermission('reports_categories_edit', subCategory.id) || hasPermission('reports_full_access')"></td>
      </tr>
    </tbody>
  </table>
</div>
