box: olger/box-yeoman
build:
  steps:
    - wercker/npm-install
    - olger/yeoman-bower-install
    - wercker/grunt:
        tasks: build
  after-steps:
    - hipchat-notify:
        token: $HIPCHAT_TOKEN
        room-id: $HIPCHAT_ROOM_ID
        from-name: wercker
# deploy to heroku
deploy:
  steps:
    - wercker/grunt:
        tasks: string-replace
    - script:
        name: create empty composer.json for cedar support
        code: touch dist/composer.json
    - script:
        name: remove current git structure
        code: rm -rf .git
    - script:
        name: create git directory from deploy source
        code: |
            cd $WERCKER_HEROKU_DEPLOY_SOURCE_DIR
            git config --global user.name '$WERCKER_HEROKU_DEPLOY_USER';
            git config --global user.email '$WERCKER_HEROKU_DEPLOY_USER';
            git init
            git add .
            git commit -m 'wercker deploy'
            cp -R .git ../
    - heroku-deploy
  after-steps:
    - hipchat-notify:
        token: $HIPCHAT_TOKEN
        room-id: $HIPCHAT_ROOM_ID
        from-name: wercker
